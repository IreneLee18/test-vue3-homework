{"ast":null,"code":"import { resolveComponent as _resolveComponent, createVNode as _createVNode, createElementVNode as _createElementVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createCommentVNode as _createCommentVNode } from \"vue\";\nconst _hoisted_1 = {\n  class: \"text-end\"\n};\nconst _hoisted_2 = {\n  class: \"table mt-4\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_createElementVNode(\"thead\", null, [/*#__PURE__*/_createElementVNode(\"tr\", {\n  class: \"row\"\n}, [/*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"新增產品日期\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"分類\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"產品名稱\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"產品圖片\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"原價\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"售價\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"是否啟用\"), /*#__PURE__*/_createElementVNode(\"th\", {\n  class: \"col\"\n}, \"編輯\")])], -1\n/* HOISTED */\n);\n\nconst _hoisted_4 = {\n  class: \"col\"\n};\nconst _hoisted_5 = {\n  class: \"col\"\n};\nconst _hoisted_6 = {\n  class: \"col\"\n};\nconst _hoisted_7 = {\n  class: \"col\"\n};\nconst _hoisted_8 = {\n  class: \"text-right\"\n};\nconst _hoisted_9 = {\n  class: \"text-right\"\n};\nconst _hoisted_10 = {\n  class: \"col\"\n};\nconst _hoisted_11 = {\n  key: 0,\n  class: \"text-success\"\n};\nconst _hoisted_12 = {\n  key: 1,\n  class: \"text-muted\"\n};\nconst _hoisted_13 = {\n  class: \"col\"\n};\nconst _hoisted_14 = {\n  class: \"btn-group\"\n};\nconst _hoisted_15 = [\"onClick\"];\nconst _hoisted_16 = [\"onClick\"];\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  const _component_LoadingView = _resolveComponent(\"LoadingView\");\n\n  const _component_product_modal = _resolveComponent(\"product-modal\");\n\n  const _component_delete_modal = _resolveComponent(\"delete-modal\");\n\n  const _component_pagination = _resolveComponent(\"pagination\");\n\n  return _openBlock(), _createElementBlock(_Fragment, null, [_createVNode(_component_LoadingView, {\n    active: $data.isLoading\n  }, null, 8\n  /* PROPS */\n  , [\"active\"]), _createElementVNode(\"div\", _hoisted_1, [_createElementVNode(\"button\", {\n    class: \"btn btn-primary\",\n    type: \"button\",\n    onClick: _cache[0] || (_cache[0] = $event => $options.openModal(true))\n  }, \" 新增產品 \")]), _createElementVNode(\"table\", _hoisted_2, [_hoisted_3, _createElementVNode(\"tbody\", null, [(_openBlock(true), _createElementBlock(_Fragment, null, _renderList($data.products, item => {\n    return _openBlock(), _createElementBlock(\"tr\", {\n      class: \"row\",\n      key: item.id\n    }, [_createElementVNode(\"td\", _hoisted_4, _toDisplayString(item.id), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_5, _toDisplayString(item.category), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_6, _toDisplayString(item.title), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_7, _toDisplayString(item.imageUrl), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_8, _toDisplayString(item.origin_price), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_9, _toDisplayString(item.price), 1\n    /* TEXT */\n    ), _createElementVNode(\"td\", _hoisted_10, [item.is_enabled ? (_openBlock(), _createElementBlock(\"span\", _hoisted_11, \"啟用\")) : (_openBlock(), _createElementBlock(\"span\", _hoisted_12, \"未啟用\"))]), _createElementVNode(\"td\", _hoisted_13, [_createElementVNode(\"div\", _hoisted_14, [_createElementVNode(\"button\", {\n      class: \"btn btn-outline-primary btn-sm\",\n      onClick: $event => $options.openModal(false, item)\n    }, \"編輯\", 8\n    /* PROPS */\n    , _hoisted_15), _createElementVNode(\"button\", {\n      class: \"btn btn-outline-danger btn-sm\",\n      onClick: $event => $options.openDeleteModal(item)\n    }, \"刪除\", 8\n    /* PROPS */\n    , _hoisted_16)])])]);\n  }), 128\n  /* KEYED_FRAGMENT */\n  ))])]), _createVNode(_component_product_modal, {\n    ref: \"showProductModal\",\n    product: $data.tempProduct,\n    onAddProduct: $options.updateProduct\n  }, null, 8\n  /* PROPS */\n  , [\"product\", \"onAddProduct\"]), _createVNode(_component_delete_modal, {\n    ref: \"showDeleteModal\",\n    product: $data.tempProduct,\n    onDeleteProduct: $options.deleteProduct\n  }, null, 8\n  /* PROPS */\n  , [\"product\", \"onDeleteProduct\"]), _createVNode(_component_pagination, {\n    pages: $data.pagination,\n    onChangePage: $options.getProducts\n  }, null, 8\n  /* PROPS */\n  , [\"pages\", \"onChangePage\"])], 64\n  /* STABLE_FRAGMENT */\n  );\n}","map":{"version":3,"mappings":"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","names":["class","_createElementVNode","_createVNode","_component_LoadingView","active","$data","type","onClick","$options","_hoisted_3","_createElementBlock","_Fragment","_renderList","item","key","id","_toDisplayString","category","title","imageUrl","origin_price","price","is_enabled","_hoisted_15","_hoisted_16","_component_product_modal","ref","product","onAddProduct","_component_delete_modal","onDeleteProduct","_component_pagination","pages","onChangePage"],"sourceRoot":"","sources":["/Users/irenelee/Desktop/vue-cli-demo/project/test1/src/views/ProductsView.vue"],"sourcesContent":["<template>\n  <LoadingView :active=\"isLoading\"></LoadingView>\n  <div class=\"text-end\">\n    <button class=\"btn btn-primary\" type=\"button\" @click=\"openModal(true)\">\n      新增產品\n    </button>\n  </div>\n  <table class=\"table mt-4\">\n    <thead>\n      <tr class=\"row\">\n        <th class=\"col\">新增產品日期</th>\n        <th class=\"col\">分類</th>\n        <th class=\"col\">產品名稱</th>\n        <th class=\"col\">產品圖片</th>\n        <th class=\"col\">原價</th>\n        <th class=\"col\">售價</th>\n        <th class=\"col\">是否啟用</th>\n        <th class=\"col\">編輯</th>\n      </tr>\n    </thead>\n    <tbody>\n      <tr class=\"row\" v-for=\"item in products\" :key=\"item.id\">\n        <td class=\"col\">{{item.id}}</td>\n        <td class=\"col\">{{item.category}}</td>\n        <td class=\"col\">{{item.title}}</td>\n        <td class=\"col\">{{item.imageUrl}}</td>\n        <td class=\"text-right\">\n          {{item.origin_price}}\n        </td>\n        <td class=\"text-right\">\n          {{item.price}}\n        </td>\n        <td class=\"col\">\n          <span class=\"text-success\" v-if=\"item.is_enabled\">啟用</span>\n          <span class=\"text-muted\" v-else>未啟用</span>\n        </td>\n        <td class=\"col\">\n          <div class=\"btn-group\">\n            <button class=\"btn btn-outline-primary btn-sm\"\n            @click=\"openModal(false,item)\"\n            >編輯</button>\n            <button class=\"btn btn-outline-danger btn-sm\"\n            @click=\"openDeleteModal(item)\"\n            >刪除</button>\n          </div>\n        </td>\n      </tr>\n    </tbody>\n  </table>\n  <product-modal ref=\"showProductModal\"\n  :product=\"tempProduct\"\n  @add-product=\"updateProduct\"\n  ></product-modal>\n  <delete-modal ref=\"showDeleteModal\"\n  :product=\"tempProduct\"\n  @delete-product=\"deleteProduct\"\n  ></delete-modal>\n  <pagination :pages=\"pagination\"\n    @change-page=\"getProducts\"\n  ></pagination>\n</template>\n\n<script>\nimport productModal from '../components/ProductModal.vue'\nimport deleteModal from '../components/DeleteModal.vue'\nimport pagination from '../components/PaginationView.vue'\nexport default {\n  data () {\n    return {\n      products: [],\n      pagination: {},\n      tempProduct: {},\n      isNewProduct: false,\n      isLoading: false\n    }\n  },\n  components: {\n    productModal,\n    deleteModal,\n    pagination\n  },\n  inject: ['emitter'],\n  methods: {\n    getProducts (page = 1) {\n      this.isLoading = true\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/products?page=${page}`\n      console.log(api)\n      this.$http.get(api)\n        .then((res) => {\n          if (res.data.success) {\n            this.isLoading = false\n            console.log(res.data)\n            this.products = res.data.products\n            this.pagination = res.data.pagination\n            // console.log(this.products, this.pagination)\n          }\n        })\n        .catch((err) => console.log(err.response))\n    },\n    // 開啟新增＆編輯\n    openModal (isNewProduct, item) {\n      // console.log(isNewProduct, item)\n      if (isNewProduct) {\n        // 每次都清空資料欄\n        this.tempProduct = {}\n      } else {\n        this.tempProduct = { ...item }\n      }\n      this.isNewProduct = isNewProduct\n      const productModalComponent = this.$refs.showProductModal\n      productModalComponent.showModal()\n    },\n    updateProduct (item) {\n      this.tempProduct = item\n\n      // 新增狀態\n      let api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product`\n      let httpMethod = 'post'\n\n      // 編輯狀態\n      if (!this.isNewProduct) {\n        api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${item.id}`\n        httpMethod = 'put'\n      }\n\n      const productModalComponent = this.$refs.showProductModal\n      this.$http[httpMethod](api, { data: this.tempProduct })\n        .then((res) => {\n          console.log(res)\n          productModalComponent.hideModal()\n          // 製作吐司列表（ 查看回傳成功與否）\n          if (res.data.success) {\n            this.getProducts()\n            this.emitter.emit('pushMsg', {\n              style: 'success',\n              title: '更新成功'\n            })\n          } else {\n            this.emitter.emit('pushMsg', {\n              style: 'danger',\n              title: '更新失敗',\n              content: res.data.message.join('、')\n            })\n          }\n        })\n        .catch((err) => console.log(err.response))\n    },\n    // 開啟刪除\n    openDeleteModal (item) {\n      this.tempProduct = { ...item }\n      const deleteModalComponent = this.$refs.showDeleteModal\n      deleteModalComponent.showModal()\n      console.log(item)\n    },\n    deleteProduct () {\n      const api = `${process.env.VUE_APP_API}api/${process.env.VUE_APP_PATH}/admin/product/${this.tempProduct.id}`\n      this.$http.delete(api, { data: this.tempProduct })\n        .then((res) => {\n          console.log(res)\n          const deleteModalComponent = this.$refs.showDeleteModal\n          deleteModalComponent.hideModal()\n          if (res.data.success) {\n            this.getProducts()\n            this.emitter.emit('pushMsg', {\n              style: 'success',\n              title: '刪除成功'\n            })\n          }\n        })\n        .catch((err) => console.log(err.response))\n    }\n  },\n  created () {\n    this.getProducts()\n  }\n}\n</script>\n"]},"metadata":{},"sourceType":"module"}